Grabbing training data...
Grabbing testing data...
Training EPOCH 0:
/Users/kelseydoerksen/opt/anaconda3/envs/aq/lib/python3.10/site-packages/torch/cuda/amp/grad_scaler.py:120: UserWarning: torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.
  warnings.warn("torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.")
quantiles_train Quantile loss is: 80.2637669245402
test set loss is: 17.607526779174805
Quantile Regression Coverage without conformal is: 0.38285585720713966
Predicting on calibration set...
test set loss is: 18.691694259643555
Calculating qyhat for calibration...
Calibrating Test set predictions...
> /Users/kelseydoerksen/code/sudsaq-kelsey-research/research/kelsey/unet/run_cqr.py(290)run_cqr()
    289     ipdb.set_trace()
--> 290     for i in range(len(uncal_predictions_t)):
    291         cal_lower_preds_t.append(uncal_predictions_t[i] - qyhat)
array([[[[-16.842419 , -17.325588 , -17.52733  , ..., -17.681602 ,
          -17.551947 , -17.3093   ],
         [-17.408548 , -18.21501  , -18.75357  , ..., -18.640833 ,
          -18.144926 , -17.66053  ],
         [-17.205276 , -18.231659 , -18.947351 , ..., -18.926098 ,
          -18.401052 , -17.74388  ],
         ...,
         [-16.97879  , -17.141958 , -17.338322 , ..., -17.150517 ,
          -17.172493 , -16.981672 ],
         [-16.877365 , -16.975334 , -17.081776 , ..., -17.046635 ,
          -17.136383 , -17.008684 ],
         [-16.884153 , -16.903858 , -16.906319 , ..., -16.987488 ,
          -16.99692  , -16.923832 ]],
        [[-15.98683  , -15.136121 , -14.454802 , ..., -14.877812 ,
          -15.966869 , -16.616194 ],
         [-14.766377 , -13.304733 , -12.130166 , ..., -13.295775 ,
          -14.948023 , -15.987898 ],
         [-14.101397 , -12.16637  , -10.690677 , ..., -12.216448 ,
          -14.191921 , -15.750907 ],
         ...,
         [-16.060156 , -15.449291 , -14.866507 , ..., -15.424579 ,
          -16.065113 , -16.725657 ],
         [-16.55671  , -16.139399 , -15.817358 , ..., -16.13912  ,
          -16.493303 , -16.89309  ],
         [-17.041056 , -16.899841 , -16.839153 , ..., -16.814854 ,
          -16.942526 , -17.09008  ]],
        [[-15.19313  , -14.548068 , -14.068463 , ..., -15.437865 ,
          -16.174334 , -16.651089 ],
         [-13.285314 , -11.811518 , -10.648714 , ..., -13.518407 ,
          -14.906511 , -16.13925  ],
         [-12.049014 ,  -9.858229 ,  -8.294012 , ..., -11.94252  ,
          -13.949288 , -15.735319 ],
         ...,
         [-15.083707 , -13.942646 , -13.12607  , ..., -14.427061 ,
          -15.423704 , -16.333    ],
         [-15.8470545, -15.033764 , -14.434211 , ..., -15.247175 ,
          -15.929037 , -16.556593 ],
         [-16.559587 , -16.16135  , -15.815529 , ..., -16.152754 ,
          -16.49459  , -16.851961 ]]],
       [[[-16.837492 , -17.316175 , -17.52199  , ..., -17.696394 ,
          -17.570232 , -17.315681 ],
         [-17.406384 , -18.215261 , -18.754208 , ..., -18.685272 ,
          -18.178944 , -17.67111  ],
         [-17.197405 , -18.226862 , -18.945631 , ..., -18.958956 ,
          -18.434082 , -17.754137 ],
         ...,
         [-16.981974 , -17.139902 , -17.344584 , ..., -17.154667 ,
          -17.178175 , -16.984444 ],
         [-16.877405 , -16.970554 , -17.08014  , ..., -17.053696 ,
          -17.144392 , -17.01228  ],
         [-16.884212 , -16.90415  , -16.902792 , ..., -16.988058 ,
          -16.997332 , -16.9231   ]],
        [[-15.98232  , -15.130709 , -14.441993 , ..., -14.819052 ,
          -15.926668 , -16.60986  ],
         [-14.761397 , -13.288559 , -12.0954   , ..., -13.195688 ,
          -14.8823185, -15.966604 ],
         [-14.085009 , -12.141136 , -10.650024 , ..., -12.095569 ,
          -14.115289 , -15.716926 ],
         ...,
         [-16.048767 , -15.433643 , -14.836329 , ..., -15.369652 ,
          -16.032001 , -16.710356 ],
         [-16.547012 , -16.126902 , -15.793628 , ..., -16.107342 ,
          -16.471895 , -16.884127 ],
         [-17.038105 , -16.890583 , -16.825071 , ..., -16.798767 ,
          -16.931892 , -17.08603  ]],
        [[-15.189076 , -14.533417 , -14.043117 , ..., -15.392545 ,
          -16.143421 , -16.632147 ],
         [-13.269357 , -11.790031 , -10.609559 , ..., -13.41935  ,
          -14.839178 , -16.099077 ],
         [-12.022907 ,  -9.817517 ,  -8.2370615, ..., -11.804489 ,
          -13.852793 , -15.68876  ],
         ...,
         [-15.070597 , -13.9141445, -13.081438 , ..., -14.344704 ,
          -15.373271 , -16.308332 ],
         [-15.837433 , -15.011715 , -14.402409 , ..., -15.194894 ,
          -15.895905 , -16.540682 ],
         [-16.554226 , -16.151363 , -15.795648 , ..., -16.123873 ,
          -16.474762 , -16.844685 ]]],
       [[[-16.831905 , -17.31586  , -17.52118  , ..., -17.670267 ,
          -17.54056  , -17.303541 ],
         [-17.392794 , -18.205755 , -18.743675 , ..., -18.6161   ,
          -18.121925 , -17.645111 ],
         [-17.194796 , -18.220732 , -18.942747 , ..., -18.884808 ,
          -18.37121  , -17.724113 ],
         ...,
         [-16.979294 , -17.138996 , -17.341988 , ..., -17.15152  ,
          -17.169413 , -16.981932 ],
         [-16.87895  , -16.984058 , -17.094492 , ..., -17.04421  ,
          -17.13317  , -17.00995  ],
         [-16.886097 , -16.900871 , -16.903822 , ..., -16.985968 ,
          -16.995405 , -16.926474 ]],
        [[-15.999506 , -15.152497 , -14.468165 , ..., -14.914459 ,
          -15.987636 , -16.629284 ],
         [-14.791787 , -13.337183 , -12.152901 , ..., -13.362593 ,
          -14.990495 , -16.016312 ],
         [-14.121361 , -12.1908245, -10.709544 , ..., -12.3029   ,
          -14.248581 , -15.780053 ],
         ...,
         [-16.047106 , -15.433238 , -14.838163 , ..., -15.449187 ,
          -16.079287 , -16.729322 ],
         [-16.54332  , -16.12629  , -15.79723  , ..., -16.147406 ,
          -16.495945 , -16.89458  ],
         [-17.039026 , -16.894623 , -16.833376 , ..., -16.813868 ,
          -16.942097 , -17.088861 ]],
        [[-15.205966 , -14.559898 , -14.079055 , ..., -15.468682 ,
          -16.18997  , -16.658861 ],
         [-13.300757 , -11.846228 , -10.682901 , ..., -13.577167 ,
          -14.941183 , -16.150267 ],
         [-12.062355 ,  -9.882705 ,  -8.329245 , ..., -12.029642 ,
          -14.001125 , -15.75669  ],
         ...,
         [-15.061563 , -13.913616 , -13.085318 , ..., -14.470775 ,
          -15.447848 , -16.346409 ],
         [-15.831738 , -15.012563 , -14.40814  , ..., -15.277631 ,
          -15.9505205, -16.569204 ],
         [-16.553656 , -16.150034 , -15.799174 , ..., -16.17301  ,
          -16.504913 , -16.854546 ]]],
       ...,
       [[[-16.831886 , -17.31831  , -17.524687 , ..., -17.691587 ,
          -17.557983 , -17.31133  ],
         [-17.396412 , -18.213495 , -18.753277 , ..., -18.656116 ,
          -18.158562 , -17.664185 ],
         [-17.196106 , -18.230282 , -18.956652 , ..., -18.93388  ,
          -18.412537 , -17.747812 ],
         ...,
         [-16.984707 , -17.150442 , -17.357655 , ..., -17.155401 ,
          -17.176989 , -16.984808 ],
         [-16.882101 , -16.990606 , -17.096685 , ..., -17.054928 ,
          -17.145536 , -17.011866 ],
         [-16.881214 , -16.90092  , -16.902243 , ..., -16.990147 ,
          -16.998356 , -16.922792 ]],
        [[-15.988546 , -15.132789 , -14.442849 , ..., -14.847574 ,
          -15.949257 , -16.61284  ],
         [-14.766888 , -13.30044  , -12.10811  , ..., -13.253207 ,
          -14.923708 , -15.981907 ],
         [-14.090642 , -12.148252 , -10.659406 , ..., -12.165531 ,
          -14.161127 , -15.736017 ],
         ...,
         [-16.043732 , -15.421262 , -14.824356 , ..., -15.389869 ,
          -16.044687 , -16.714962 ],
         [-16.534546 , -16.105404 , -15.785209 , ..., -16.120626 ,
          -16.480062 , -16.88829  ],
         [-17.03319  , -16.890825 , -16.83131  , ..., -16.807775 ,
          -16.939896 , -17.089048 ]],
        [[-15.190609 , -14.538061 , -14.050896 , ..., -15.418962 ,
          -16.162859 , -16.643972 ],
         [-13.26933  , -11.7954035, -10.620264 , ..., -13.475723 ,
          -14.879026 , -16.122183 ],
         [-12.02264  ,  -9.823598 ,  -8.255039 , ..., -11.878856 ,
          -13.909193 , -15.720174 ],
         ...,
         [-15.045117 , -13.890068 , -13.069622 , ..., -14.38136  ,
          -15.39489  , -16.320772 ],
         [-15.819405 , -14.996722 , -14.397986 , ..., -15.2138   ,
          -15.910494 , -16.547153 ],
         [-16.542057 , -16.13734  , -15.796154 , ..., -16.1363   ,
          -16.48459  , -16.846024 ]]],
       [[[-16.835888 , -17.315004 , -17.519968 , ..., -17.710804 ,
          -17.574833 , -17.32072  ],
         [-17.396763 , -18.20223  , -18.738743 , ..., -18.705982 ,
          -18.198296 , -17.680544 ],
         [-17.194235 , -18.218012 , -18.931633 , ..., -18.988747 ,
          -18.455276 , -17.764894 ],
         ...,
         [-16.982994 , -17.146164 , -17.349367 , ..., -17.176483 ,
          -17.192968 , -16.989204 ],
         [-16.877449 , -16.977629 , -17.080145 , ..., -17.068037 ,
          -17.157534 , -17.01682  ],
         [-16.883131 , -16.903439 , -16.906635 , ..., -16.992777 ,
          -16.999237 , -16.920954 ]],
        [[-15.9963255, -15.152283 , -14.468309 , ..., -14.784115 ,
          -15.912614 , -16.603558 ],
         [-14.789619 , -13.3369465, -12.152185 , ..., -13.140258 ,
          -14.853361 , -15.9555645],
         [-14.116394 , -12.194166 , -10.720755 , ..., -12.019963 ,
          -14.072287 , -15.700577 ],
         ...,
         [-16.064442 , -15.454612 , -14.8622465, ..., -15.305746 ,
          -15.9912815, -16.698046 ],
         [-16.552267 , -16.138203 , -15.814196 , ..., -16.063639 ,
          -16.437532 , -16.869726 ],
         [-17.043615 , -16.899338 , -16.8427   , ..., -16.785604 ,
          -16.921984 , -17.083302 ]],
        [[-15.209328 , -14.562318 , -14.079789 , ..., -15.3696165,
          -16.128778 , -16.628143 ],
         [-13.308261 , -11.84503  , -10.678856 , ..., -13.362882 ,
          -14.806246 , -16.085236 ],
         [-12.075073 ,  -9.892292 ,  -8.334188 , ..., -11.717224 ,
          -13.797016 , -15.670287 ],
         ...,
         [-15.085709 , -13.949383 , -13.1306095, ..., -14.26417  ,
          -15.311995 , -16.277979 ],
         [-15.844118 , -15.034953 , -14.4325485, ..., -15.121169 ,
          -15.842704 , -16.511442 ],
         [-16.557463 , -16.158236 , -15.81817  , ..., -16.080387 ,
          -16.440321 , -16.823256 ]]],
       [[[-16.835028 , -17.307552 , -17.509892 , ..., -17.68243  ,
          -17.554586 , -17.310997 ],
         [-17.38313  , -18.1773   , -18.700657 , ..., -18.631474 ,
          -18.14339  , -17.659178 ],
         [-17.186575 , -18.19123  , -18.895256 , ..., -18.921242 ,
          -18.395216 , -17.738796 ],
         ...,
         [-16.982965 , -17.140507 , -17.343287 , ..., -17.155964 ,
          -17.180254 , -16.986635 ],
         [-16.883165 , -16.979275 , -17.089443 , ..., -17.050707 ,
          -17.142107 , -17.00998  ],
         [-16.884787 , -16.90342  , -16.905645 , ..., -16.985708 ,
          -16.99629  , -16.923136 ]],
        [[-16.022926 , -15.1913805, -14.519997 , ..., -14.880689 ,
          -15.962238 , -16.6192   ],
         [-14.838632 , -13.414404 , -12.255354 , ..., -13.292864 ,
          -14.940091 , -15.995822 ],
         [-14.18322  , -12.296667 , -10.849951 , ..., -12.220085 ,
          -14.190048 , -15.753605 ],
         ...,
         [-16.079187 , -15.476937 , -14.894838 , ..., -15.399489 ,
          -16.050241 , -16.71979  ],
         [-16.554024 , -16.13972  , -15.820665 , ..., -16.123135 ,
          -16.482077 , -16.888027 ],
         [-17.040085 , -16.89976  , -16.840086 , ..., -16.801918 ,
          -16.935087 , -17.087645 ]],
        [[-15.246321 , -14.61244  , -14.139498 , ..., -15.439899 ,
          -16.169886 , -16.646465 ],
         [-13.383411 , -11.951782 , -10.806919 , ..., -13.512302 ,
          -14.904208 , -16.130774 ],
         [-12.172461 , -10.037328 ,  -8.509872 , ..., -11.939501 ,
          -13.941231 , -15.729475 ],
         ...,
         [-15.113838 , -13.985668 , -13.190142 , ..., -14.40623  ,
          -15.408464 , -16.32634  ],
         [-15.861887 , -15.060755 , -14.476971 , ..., -15.231463 ,
          -15.919019 , -16.551308 ],
         [-16.564234 , -16.171293 , -15.835323 , ..., -16.147015 ,
          -16.48824  , -16.8496   ]]]], dtype=float32)
*** IndexError: boolean index did not match indexed array along dimension 0; dimension is 30 but corresponding boolean dimension is 31
Traceback (most recent call last):
  File "/Users/kelseydoerksen/code/sudsaq-kelsey-research/research/kelsey/unet/run_pipeline.py", line 136, in <module>
    run_cqr(unet, device, aq_train_dataset, aq_test_dataset, save_dir, experiment, 0.2, args.channels,
  File "/Users/kelseydoerksen/code/sudsaq-kelsey-research/research/kelsey/unet/run_cqr.py", line 290, in run_cqr
    for i in range(len(uncal_predictions_t)):
  File "/Users/kelseydoerksen/code/sudsaq-kelsey-research/research/kelsey/unet/run_cqr.py", line 290, in run_cqr
    for i in range(len(uncal_predictions_t)):
  File "/Users/kelseydoerksen/opt/anaconda3/envs/aq/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/Users/kelseydoerksen/opt/anaconda3/envs/aq/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
If you suspect this is an IPython 8.7.0 bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org
You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.
Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True