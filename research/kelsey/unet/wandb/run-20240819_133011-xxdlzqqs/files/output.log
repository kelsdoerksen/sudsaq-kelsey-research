Grabbing training data...
Grabbing testing data...
Training lower bound model...
Training EPOCH 0:
/Users/kelseydoerksen/opt/anaconda3/envs/sudsaq-uq/lib/python3.10/site-packages/torch/cuda/amp/grad_scaler.py:126: UserWarning: torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.
  warnings.warn(
Training EPOCH 1:
Training upper bound model...
Training EPOCH 0:
Training EPOCH 1:
Predicting lower bounds...
test set loss is: 16.383743286132812
Predicting upper bounds...
test set loss is: 2.134387254714966
> /Users/kelseydoerksen/code/sudsaq-kelsey-research/research/kelsey/unet/run_cqr.py(133)calculate_coverage()
    132     ipdb.set_trace()
--> 133     lower = []
    134     upper = []
array([[[[ 1.7808517 ,  3.183033  ,  4.2540755 , ...,  4.206134  ,
           2.8698494 ,  1.4295568 ],
         [ 3.382619  ,  6.0664334 ,  8.050257  , ...,  7.9880586 ,
           5.425636  ,  2.6394026 ],
         [ 4.552414  ,  8.128724  , 10.794766  , ..., 10.767881  ,
           7.2603045 ,  3.5281293 ],
         ...,
         [ 2.2375238 ,  3.93039   ,  5.0061665 , ...,  4.702257  ,
           3.1528203 ,  1.4912462 ],
         [ 1.5056963 ,  2.6543505 ,  3.406914  , ...,  3.231778  ,
           2.2082522 ,  1.0803478 ],
         [ 0.7409191 ,  1.333376  ,  1.7053989 , ...,  1.5722077 ,
           1.0835769 ,  0.51837814]]],
       [[[ 1.7471453 ,  3.1229844 ,  4.1671715 , ...,  3.897921  ,
           2.674845  ,  1.3399757 ],
         [ 3.3206625 ,  5.95423   ,  7.8875203 , ...,  7.4315042 ,
           5.0761027 ,  2.4778154 ],
         [ 4.465349  ,  7.97363   , 10.575183  , ..., 10.060925  ,
           6.808693  ,  3.3210785 ],
         ...,
         [ 2.1318452 ,  3.742374  ,  4.759731  , ...,  4.6817365 ,
           3.1254132 ,  1.4781379 ],
         [ 1.4367999 ,  2.524692  ,  3.2300153 , ...,  3.2275317 ,
           2.1852567 ,  1.0654935 ],
         [ 0.7054584 ,  1.2633042 ,  1.6059003 , ...,  1.5826824 ,
           1.0773364 ,  0.5144366 ]]],
       [[[ 1.6541812 ,  2.9592903 ,  3.9545777 , ...,  3.8938544 ,
           2.6618981 ,  1.3273891 ],
         [ 3.1460922 ,  5.6468062 ,  7.4915185 , ...,  7.413391  ,
           5.0481114 ,  2.459029  ],
         [ 4.2382803 ,  7.5735598 , 10.059115  , ..., 10.024365  ,
           6.7769513 ,  3.2986429 ],
         ...,
         [ 2.1641934 ,  3.8055596 ,  4.8376384 , ...,  4.4109335 ,
           2.9599242 ,  1.4022104 ],
         [ 1.4819106 ,  2.612301  ,  3.338526  , ...,  3.075737  ,
           2.112027  ,  1.0397234 ],
         [ 0.74448186,  1.332054  ,  1.6919192 , ...,  1.519082  ,
           1.0571207 ,  0.5134448 ]]],
       ...,
       [[[ 1.6951853 ,  3.0322485 ,  4.0532594 , ...,  3.9903753 ,
           2.7080386 ,  1.3406483 ],
         [ 3.224218  ,  5.7862525 ,  7.68129   , ...,  7.611139  ,
           5.15248   ,  2.4957643 ],
         [ 4.3453317 ,  7.764805  , 10.320642  , ..., 10.327796  ,
           6.946199  ,  3.3722506 ],
         ...,
         [ 2.18606   ,  3.8223548 ,  4.8216    , ...,  4.6074867 ,
           3.116876  ,  1.489985  ],
         [ 1.4922155 ,  2.6127892 ,  3.3110287 , ...,  3.2028074 ,
           2.2221296 ,  1.105538  ],
         [ 0.7467259 ,  1.3278562 ,  1.6697572 , ...,  1.5794132 ,
           1.1138713 ,  0.5488445 ]]],
       [[[ 1.7884709 ,  3.1929493 ,  4.257356  , ...,  4.1178117 ,
           2.8059447 ,  1.3969227 ],
         [ 3.3988461 ,  6.087916  ,  8.05712   , ...,  7.824087  ,
           5.313453  ,  2.584064  ],
         [ 4.5710745 ,  8.154141  , 10.807229  , ..., 10.551805  ,
           7.1192384 ,  3.4621093 ],
         ...,
         [ 2.2661088 ,  3.9841886 ,  5.071214  , ...,  4.345321  ,
           2.8635497 ,  1.3252829 ],
         [ 1.5487423 ,  2.7268677 ,  3.4864972 , ...,  2.934732  ,
           1.9725168 ,  0.948238  ],
         [ 0.7756721 ,  1.3863243 ,  1.7601117 , ...,  1.3919982 ,
           0.94429445,  0.43860617]]],
       [[[ 1.7989051 ,  3.215557  ,  4.2917604 , ...,  4.102562  ,
           2.8050854 ,  1.4014447 ],
         [ 3.416532  ,  6.127358  ,  8.117054  , ...,  7.8002872 ,
           5.3134713 ,  2.593038  ],
         [ 4.582854  ,  8.184793  , 10.856249  , ..., 10.527401  ,
           7.1245155 ,  3.4744995 ],
         ...,
         [ 2.2210522 ,  3.9075296 ,  4.9775796 , ...,  4.4692707 ,
           2.979147  ,  1.395871  ],
         [ 1.5260482 ,  2.687862  ,  3.4407806 , ...,  3.063642  ,
           2.082761  ,  1.0118704 ],
         [ 0.76735467,  1.3715048 ,  1.7448996 , ...,  1.4824548 ,
           1.0164621 ,  0.4822971 ]]]], dtype=float32)
(32, 1, 31, 49)
*** TypeError: 'DataLoader' object is not subscriptable
<torch.utils.data.dataloader.DataLoader object at 0x12bcb63e0>
[array([[[[ 1.7808517 ,  3.183033  ,  4.2540755 , ...,  4.206134  ,
           2.8698494 ,  1.4295568 ],
         [ 3.382619  ,  6.0664334 ,  8.050257  , ...,  7.9880586 ,
           5.425636  ,  2.6394026 ],
         [ 4.552414  ,  8.128724  , 10.794766  , ..., 10.767881  ,
           7.2603045 ,  3.5281293 ],
         ...,
         [ 2.2375238 ,  3.93039   ,  5.0061665 , ...,  4.702257  ,
           3.1528203 ,  1.4912462 ],
         [ 1.5056963 ,  2.6543505 ,  3.406914  , ...,  3.231778  ,
           2.2082522 ,  1.0803478 ],
         [ 0.7409191 ,  1.333376  ,  1.7053989 , ...,  1.5722077 ,
           1.0835769 ,  0.51837814]]],
       [[[ 1.7471453 ,  3.1229844 ,  4.1671715 , ...,  3.897921  ,
           2.674845  ,  1.3399757 ],
         [ 3.3206625 ,  5.95423   ,  7.8875203 , ...,  7.4315042 ,
           5.0761027 ,  2.4778154 ],
         [ 4.465349  ,  7.97363   , 10.575183  , ..., 10.060925  ,
           6.808693  ,  3.3210785 ],
         ...,
         [ 2.1318452 ,  3.742374  ,  4.759731  , ...,  4.6817365 ,
           3.1254132 ,  1.4781379 ],
         [ 1.4367999 ,  2.524692  ,  3.2300153 , ...,  3.2275317 ,
           2.1852567 ,  1.0654935 ],
         [ 0.7054584 ,  1.2633042 ,  1.6059003 , ...,  1.5826824 ,
           1.0773364 ,  0.5144366 ]]],
       [[[ 1.6541812 ,  2.9592903 ,  3.9545777 , ...,  3.8938544 ,
           2.6618981 ,  1.3273891 ],
         [ 3.1460922 ,  5.6468062 ,  7.4915185 , ...,  7.413391  ,
           5.0481114 ,  2.459029  ],
         [ 4.2382803 ,  7.5735598 , 10.059115  , ..., 10.024365  ,
           6.7769513 ,  3.2986429 ],
         ...,
         [ 2.1641934 ,  3.8055596 ,  4.8376384 , ...,  4.4109335 ,
           2.9599242 ,  1.4022104 ],
         [ 1.4819106 ,  2.612301  ,  3.338526  , ...,  3.075737  ,
           2.112027  ,  1.0397234 ],
         [ 0.74448186,  1.332054  ,  1.6919192 , ...,  1.519082  ,
           1.0571207 ,  0.5134448 ]]],
       ...,
       [[[ 1.6951853 ,  3.0322485 ,  4.0532594 , ...,  3.9903753 ,
           2.7080386 ,  1.3406483 ],
         [ 3.224218  ,  5.7862525 ,  7.68129   , ...,  7.611139  ,
           5.15248   ,  2.4957643 ],
         [ 4.3453317 ,  7.764805  , 10.320642  , ..., 10.327796  ,
           6.946199  ,  3.3722506 ],
         ...,
         [ 2.18606   ,  3.8223548 ,  4.8216    , ...,  4.6074867 ,
           3.116876  ,  1.489985  ],
         [ 1.4922155 ,  2.6127892 ,  3.3110287 , ...,  3.2028074 ,
           2.2221296 ,  1.105538  ],
         [ 0.7467259 ,  1.3278562 ,  1.6697572 , ...,  1.5794132 ,
           1.1138713 ,  0.5488445 ]]],
       [[[ 1.7884709 ,  3.1929493 ,  4.257356  , ...,  4.1178117 ,
           2.8059447 ,  1.3969227 ],
         [ 3.3988461 ,  6.087916  ,  8.05712   , ...,  7.824087  ,
           5.313453  ,  2.584064  ],
         [ 4.5710745 ,  8.154141  , 10.807229  , ..., 10.551805  ,
           7.1192384 ,  3.4621093 ],
         ...,
         [ 2.2661088 ,  3.9841886 ,  5.071214  , ...,  4.345321  ,
           2.8635497 ,  1.3252829 ],
         [ 1.5487423 ,  2.7268677 ,  3.4864972 , ...,  2.934732  ,
           1.9725168 ,  0.948238  ],
         [ 0.7756721 ,  1.3863243 ,  1.7601117 , ...,  1.3919982 ,
           0.94429445,  0.43860617]]],
       [[[ 1.7989051 ,  3.215557  ,  4.2917604 , ...,  4.102562  ,
           2.8050854 ,  1.4014447 ],
         [ 3.416532  ,  6.127358  ,  8.117054  , ...,  7.8002872 ,
           5.3134713 ,  2.593038  ],
         [ 4.582854  ,  8.184793  , 10.856249  , ..., 10.527401  ,
           7.1245155 ,  3.4744995 ],
         ...,
         [ 2.2210522 ,  3.9075296 ,  4.9775796 , ...,  4.4692707 ,
           2.979147  ,  1.395871  ],
         [ 1.5260482 ,  2.687862  ,  3.4407806 , ...,  3.063642  ,
           2.082761  ,  1.0118704 ],
         [ 0.76735467,  1.3715048 ,  1.7448996 , ...,  1.4824548 ,
           1.0164621 ,  0.4822971 ]]]], dtype=float32), array([[[[ 1.7930517 ,  3.2038367 ,  4.2793818 , ...,  4.1654873 ,
           2.8452024 ,  1.4187988 ],
         [ 3.4072902 ,  6.109332  ,  8.102172  , ...,  7.9284062 ,
           5.394793  ,  2.6265373 ],
         [ 4.585686  ,  8.188322  , 10.872921  , ..., 10.722133  ,
           7.242202  ,  3.525375  ],
         ...,
         [ 2.255275  ,  3.961705  ,  5.0448723 , ...,  4.6002812 ,
           3.0754752 ,  1.4468857 ],
         [ 1.5421531 ,  2.7155812 ,  3.4734235 , ...,  3.1259828 ,
           2.1285503 ,  1.0364761 ],
         [ 0.7718021 ,  1.3812951 ,  1.754742  , ...,  1.5015593 ,
           1.0314608 ,  0.48960075]]],
       [[[ 1.7166963 ,  3.0693395 ,  4.1014113 , ...,  3.7498028 ,
           2.5478272 ,  1.2597107 ],
         [ 3.2600067 ,  5.8473206 ,  7.7602487 , ...,  7.1322813 ,
           4.8252397 ,  2.3281753 ],
         [ 4.387101  ,  7.8349304 , 10.409545  , ...,  9.638128  ,
           6.466489  ,  3.122554  ],
         ...,
         [ 2.2006233 ,  3.8710692 ,  4.9381084 , ...,  4.569592  ,
           3.0915892 ,  1.4801984 ],
         [ 1.4893746 ,  2.6260133 ,  3.370809  , ...,  3.1629822 ,
           2.18182   ,  1.0791636 ],
         [ 0.7374754 ,  1.3244095 ,  1.6904823 , ...,  1.5548791 ,
           1.0844691 ,  0.52798426]]],
       [[[ 1.7212592 ,  3.0740654 ,  4.102287  , ...,  3.8783715 ,
           2.6492493 ,  1.317825  ],
         [ 3.2706246 ,  5.8611913 ,  7.7672725 , ...,  7.3722315 ,
           5.0103564 ,  2.4318907 ],
         [ 4.4029565 ,  7.858658  , 10.42738   , ...,  9.941153  ,
           6.6932235 ,  3.246707  ],
         ...,
         [ 2.1614048 ,  3.79395   ,  4.8233843 , ...,  4.7992654 ,
           3.245065  ,  1.5571944 ],
         [ 1.4659729 ,  2.5750523 ,  3.2912986 , ...,  3.350257  ,
           2.2982702 ,  1.1331182 ],
         [ 0.72681105,  1.298261  ,  1.6481788 , ...,  1.6684186 ,
           1.1522412 ,  0.55965817]]],
       ...,
       [[[ 1.7868506 ,  3.1920626 ,  4.261451  , ...,  4.0229445 ,
           2.7365265 ,  1.3572804 ],
         [ 3.3957818 ,  6.0876045 ,  8.070685  , ...,  7.652615  ,
           5.1848574 ,  2.515333  ],
         [ 4.574309  ,  8.1660595 , 10.837355  , ..., 10.336986  ,
           6.958374  ,  3.378409  ],
         ...,
         [ 2.1800842 ,  3.8229449 ,  4.865833  , ...,  4.463162  ,
           2.9687607 ,  1.3895348 ],
         [ 1.4624274 ,  2.5621774 ,  3.2732937 , ...,  3.050643  ,
           2.0650785 ,  1.0008588 ],
         [ 0.71386856,  1.2735648 ,  1.6134409 , ...,  1.4738381 ,
           1.004855  ,  0.47421303]]],
       [[[ 1.757427  ,  3.1382747 ,  4.1881247 , ...,  4.0676394 ,
           2.7772193 ,  1.3842708 ],
         [ 3.3390207 ,  5.983589  ,  7.928957  , ...,  7.740189  ,
           5.263759  ,  2.563238  ],
         [ 4.491794  ,  8.017458  , 10.638444  , ..., 10.457231  ,
           7.062792  ,  3.43651   ],
         ...,
         [ 2.2433147 ,  3.9455256 ,  5.0184493 , ...,  4.648515  ,
           3.1297596 ,  1.4875218 ],
         [ 1.5408608 ,  2.7160826 ,  3.4747307 , ...,  3.193124  ,
           2.1893551 ,  1.0753142 ],
         [ 0.7747284 ,  1.3883078 ,  1.7655721 , ...,  1.5542587 ,
           1.0756779 ,  0.5173178 ]]],
       [[[ 1.7376692 ,  3.105522  ,  4.1444144 , ...,  3.983769  ,
           2.7131195 ,  1.3479749 ],
         [ 3.2985263 ,  5.9150777 ,  7.841285  , ...,  7.573757  ,
           5.139371  ,  2.4978733 ],
         [ 4.4315014 ,  7.916177  , 10.510465  , ..., 10.221541  ,
           6.8949566 ,  3.3534129 ],
         ...,
         [ 2.1836648 ,  3.83355   ,  4.8710003 , ...,  4.6845717 ,
           3.1778634 ,  1.5291559 ],
         [ 1.4796348 ,  2.6026187 ,  3.3267074 , ...,  3.2614849 ,
           2.2588108 ,  1.1244516 ],
         [ 0.73432994,  1.3142695 ,  1.6695786 , ...,  1.6159292 ,
           1.1331576 ,  0.55698436]]]], dtype=float32), array([[[[ 1.7116578 ,  3.0572655 ,  4.080205  , ...,  3.972195  ,
           2.6988475 ,  1.3367336 ],
         [ 3.2528656 ,  5.83027   ,  7.726627  , ...,  7.5536995 ,
           5.112247  ,  2.475478  ],
         [ 4.3750615 ,  7.810439  , 10.363679  , ..., 10.200056  ,
           6.85913   ,  3.3256922 ],
         ...,
         [ 2.0411308 ,  3.584589  ,  4.56734   , ...,  4.5355487 ,
           3.0454867 ,  1.4435064 ],
         [ 1.3867593 ,  2.4336603 ,  3.1159418 , ...,  3.1104548 ,
           2.1239245 ,  1.0383646 ],
         [ 0.68426555,  1.2233484 ,  1.5567137 , ...,  1.511566  ,
           1.0390321 ,  0.49559692]]],
       [[[ 1.8312372 ,  3.27094   ,  4.3639603 , ...,  4.140183  ,
           2.8188512 ,  1.4023284 ],
         [ 3.4754603 ,  6.2316    ,  8.257438  , ...,  7.862778  ,
           5.3346567 ,  2.593852  ],
         [ 4.6661453 ,  8.332332  , 11.064756  , ..., 10.604831  ,
           7.1497355 ,  3.4759364 ],
         ...,
         [ 2.2207608 ,  3.909289  ,  4.996757  , ...,  4.671539  ,
           3.155736  ,  1.5055926 ],
         [ 1.5055535 ,  2.6537192 ,  3.4118743 , ...,  3.2152019 ,
           2.2220697 ,  1.099627  ],
         [ 0.74703825,  1.3402905 ,  1.7132463 , ...,  1.5695632 ,
           1.0995235 ,  0.5361419 ]]],
       [[[ 1.6753309 ,  2.9956653 ,  4.0017486 , ...,  3.959918  ,
           2.693849  ,  1.3375928 ],
         [ 3.1880746 ,  5.718732  ,  7.5834756 , ...,  7.521859  ,
           5.0991783 ,  2.4754229 ],
         [ 4.29763   ,  7.675363  , 10.188726  , ..., 10.144217  ,
           6.8332343 ,  3.3185022 ],
         ...,
         [ 2.0050921 ,  3.5025933 ,  4.4324036 , ...,  4.621572  ,
           3.1231902 ,  1.496012  ],
         [ 1.2996624 ,  2.2745483 ,  2.905309  , ...,  3.2129455 ,
           2.2143705 ,  1.0966375 ],
         [ 0.6114507 ,  1.0955572 ,  1.3940167 , ...,  1.590579  ,
           1.1082598 ,  0.5421349 ]]],
       ...,
       [[[ 1.7481877 ,  3.123472  ,  4.1700644 , ...,  4.0373416 ,
           2.7798786 ,  1.4002979 ],
         [ 3.3191476 ,  5.9497867 ,  7.890343  , ...,  7.690741  ,
           5.2700224 ,  2.5867906 ],
         [ 4.4641757 ,  7.969891  , 10.580261  , ..., 10.4025135 ,
           7.063354  ,  3.4546537 ],
         ...,
         [ 2.1352515 ,  3.744612  ,  4.758356  , ...,  4.5022244 ,
           3.0067916 ,  1.412873  ],
         [ 1.4470756 ,  2.536016  ,  3.2367413 , ...,  3.0880811 ,
           2.102079  ,  1.0233828 ],
         [ 0.71503323,  1.2738833 ,  1.6148858 , ...,  1.4948804 ,
           1.0265527 ,  0.48794544]]],
       [[[ 1.7015132 ,  3.0403097 ,  4.0589137 , ...,  4.02246   ,
           2.754061  ,  1.3786805 ],
         [ 3.235169  ,  5.8009048 ,  7.6907797 , ...,  7.654489  ,
           5.2213373 ,  2.5528898 ],
         [ 4.3543453 ,  7.778229  , 10.327586  , ..., 10.333991  ,
           7.0013704 ,  3.4188707 ],
         ...,
         [ 2.038163  ,  3.585928  ,  4.582182  , ...,  4.380547  ,
           2.8932333 ,  1.3431133 ],
         [ 1.3835065 ,  2.4336805 ,  3.1236732 , ...,  3.019955  ,
           2.0313463 ,  0.97855425],
         [ 0.6835484 ,  1.2245563 ,  1.5629847 , ...,  1.4702735 ,
           0.9962466 ,  0.46846503]]],
       [[[ 1.6920841 ,  3.0267117 ,  4.0412407 , ...,  3.9516969 ,
           2.687337  ,  1.3329226 ],
         [ 3.217444  ,  5.773899  ,  7.6522355 , ...,  7.5120897 ,
           5.092219  ,  2.4721942 ],
         [ 4.3258104 ,  7.7290845 , 10.25381   , ..., 10.144319  ,
           6.8366594 ,  3.32121   ],
         ...,
         [ 2.067303  ,  3.625845  ,  4.5989347 , ...,  4.528675  ,
           3.0459309 ,  1.4472678 ],
         [ 1.4112633 ,  2.475895  ,  3.1569395 , ...,  3.124634  ,
           2.1415882 ,  1.0522522 ],
         [ 0.7035207 ,  1.2546288 ,  1.5890565 , ...,  1.5281026 ,
           1.0562723 ,  0.5077351 ]]]], dtype=float32)]
<class 'list'>
3
Traceback (most recent call last):
  File "/Users/kelseydoerksen/code/sudsaq-kelsey-research/research/kelsey/unet/run_pipeline.py", line 131, in <module>
    run_cqr(unet, device, aq_train_dataset, aq_test_dataset, save_dir, experiment, 0.1, args.channels,
  File "/Users/kelseydoerksen/code/sudsaq-kelsey-research/research/kelsey/unet/run_cqr.py", line 218, in run_cqr
    upper_cal_preds = cqr_testing_loop(upper_bound, 'upper_cal', 'bias', cal_loader, lower_criterion,
  File "/Users/kelseydoerksen/code/sudsaq-kelsey-research/research/kelsey/unet/run_cqr.py", line 133, in calculate_coverage
    lower_list = []
  File "/Users/kelseydoerksen/code/sudsaq-kelsey-research/research/kelsey/unet/run_cqr.py", line 133, in calculate_coverage
    lower_list = []
  File "/Users/kelseydoerksen/opt/anaconda3/envs/sudsaq-uq/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/Users/kelseydoerksen/opt/anaconda3/envs/sudsaq-uq/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
If you suspect this is an IPython 8.25.0 bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org
You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.
Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True