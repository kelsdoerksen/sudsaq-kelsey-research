/Users/kelseydoerksen/opt/anaconda3/envs/sudsaq-uq/lib/python3.10/site-packages/torch/cuda/amp/grad_scaler.py:126: UserWarning: torch.cuda.amp.GradScaler is enabled, but CUDA is not available.  Disabling.
  warnings.warn(
Grabbing training data...
Grabbing testing data...
Training EPOCH 0:
quantiles_train Quantile loss is: 53.9158552069413
Training EPOCH 1:
quantiles_train Quantile loss is: 43.87189945421721
test set loss is: 36.552616119384766
> /Users/kelseydoerksen/code/sudsaq-kelsey-research/research/kelsey/unet/run_cqr.py(305)run_cqr()
    304     ipdb.set_trace()
--> 305     if len(uncal_predictions_t) > 2:
    306         uncal_coverage = calculate_coverage(uncal_predictions_t[0][:,0,:,:], uncal_predictions_t[0][:,2,:,:], test_loader)
<class 'numpy.ndarray'>
array([[[[-0.2921894 , -0.5135587 , -0.6291803 , ..., -0.52668434,
          -0.4325815 , -0.3104739 ],
         [-0.40164134, -0.78376794, -0.9881728 , ..., -0.83328545,
          -0.6798244 , -0.46391937],
         [-0.47702843, -0.95529604, -1.2212341 , ..., -1.0406736 ,
          -0.84828705, -0.5781281 ],
         ...,
         [-0.77130306, -1.699301  , -2.1270034 , ..., -1.6918212 ,
          -1.3875467 , -0.899925  ],
         [-0.57888335, -1.2522281 , -1.5744541 , ..., -1.1948444 ,
          -1.0143576 , -0.67468023],
         [-0.34966844, -0.7302416 , -0.9050364 , ..., -0.6520685 ,
          -0.53951776, -0.36357555]],
        [[ 0.419052  ,  0.71949714,  0.8879264 , ...,  0.6829499 ,
           0.5367053 ,  0.33075935],
         [ 0.73612964,  1.3252653 ,  1.6501285 , ...,  1.2223564 ,
           0.92942685,  0.5347966 ],
         [ 0.9550744 ,  1.7585065 ,  2.205335  , ...,  1.6650118 ,
           1.2678015 ,  0.71549314],
         ...,
         [ 1.8689578 ,  3.3704228 ,  4.066077  , ...,  3.07364   ,
           2.3379273 ,  1.3069936 ],
         [ 1.450374  ,  2.6195838 ,  3.1518333 , ...,  2.2833097 ,
           1.7726225 ,  1.0193845 ],
         [ 0.81590873,  1.4417901 ,  1.7386453 , ...,  1.2506385 ,
           1.0126759 ,  0.6240926 ]],
        [[ 0.6824658 ,  1.2163914 ,  1.4974462 , ...,  1.0772103 ,
           0.79715234,  0.44099143],
         [ 1.183377  ,  2.1462312 ,  2.6696408 , ...,  1.9210289 ,
           1.4324007 ,  0.7858632 ],
         [ 1.5275836 ,  2.8009446 ,  3.522881  , ...,  2.6083817 ,
           1.9628315 ,  1.0867655 ],
         ...,
         [ 2.904144  ,  5.313362  ,  6.462374  , ...,  4.7198124 ,
           3.5922928 ,  2.01315   ],
         [ 2.1680431 ,  3.9859426 ,  4.87871   , ...,  3.4112256 ,
           2.6395159 ,  1.5161132 ],
         [ 1.1539088 ,  2.0807083 ,  2.6002736 , ...,  1.774989  ,
           1.4101865 ,  0.84577405]]],
       [[[-0.29526293, -0.52102774, -0.6414684 , ..., -0.543447  ,
          -0.44593686, -0.32153988],
         [-0.4077056 , -0.7978816 , -1.0101622 , ..., -0.86237514,
          -0.70833564, -0.47886795],
         [-0.4858822 , -0.981258  , -1.2621682 , ..., -1.0613523 ,
          -0.8642253 , -0.58853894],
         ...,
         [-0.7519144 , -1.6629475 , -2.0840592 , ..., -1.6411835 ,
          -1.3223176 , -0.8455143 ],
         [-0.5552304 , -1.1915836 , -1.5115428 , ..., -1.1596172 ,
          -0.97125316, -0.64486104],
         [-0.33332178, -0.6901132 , -0.86053526, ..., -0.6322202 ,
          -0.5219965 , -0.3514139 ]],
        [[ 0.42348495,  0.7321804 ,  0.9090136 , ...,  0.7080476 ,
           0.55627275,  0.3430083 ],
         [ 0.7471444 ,  1.3516529 ,  1.6963503 , ...,  1.2618179 ,
           0.95565504,  0.5471222 ],
         [ 0.9757399 ,  1.8073922 ,  2.2852488 , ...,  1.6940969 ,
           1.2838793 ,  0.7208928 ],
         ...,
         [ 1.8412843 ,  3.315076  ,  4.0139937 , ...,  2.9689624 ,
           2.2216902 ,  1.2257205 ],
         [ 1.3888162 ,  2.5291173 ,  3.0632172 , ...,  2.2062585 ,
           1.6907728 ,  0.9590302 ],
         [ 0.77019995,  1.3654143 ,  1.6640434 , ...,  1.2127708 ,
           0.9714598 ,  0.5933844 ]],
        [[ 0.6890477 ,  1.2371098 ,  1.5333637 , ...,  1.1234847 ,
           0.8357989 ,  0.46268994],
         [ 1.2010329 ,  2.1912377 ,  2.745447  , ...,  1.9847127 ,
           1.4814103 ,  0.81255823],
         [ 1.5634544 ,  2.8830662 ,  3.650762  , ...,  2.6440675 ,
           1.9891229 ,  1.0999079 ],
         ...,
         [ 2.8359666 ,  5.198029  ,  6.3561873 , ...,  4.543022  ,
           3.399419  ,  1.8770934 ],
         [ 2.0719469 ,  3.821376  ,  4.72169   , ...,  3.2828224 ,
           2.505812  ,  1.4195497 ],
         [ 1.0849231 ,  1.9604605 ,  2.481332  , ...,  1.7097183 ,
           1.3454269 ,  0.8000393 ]]],
       [[[-0.3107261 , -0.55614936, -0.6803846 , ..., -0.51028687,
          -0.41877317, -0.3019261 ],
         [-0.43447757, -0.85760516, -1.0819658 , ..., -0.78872794,
          -0.64460444, -0.436926  ],
         [-0.50878763, -1.036731  , -1.3337412 , ..., -0.95918655,
          -0.77589226, -0.5250164 ],
         ...,
         [-0.8231201 , -1.8440014 , -2.3354046 , ..., -1.7488292 ,
          -1.4187931 , -0.9118243 ],
         [-0.60407686, -1.3304368 , -1.6931103 , ..., -1.2297121 ,
          -1.0273918 , -0.68031085],
         [-0.35851166, -0.76545495, -0.96041536, ..., -0.6635578 ,
          -0.54495144, -0.36364946]],
        [[ 0.4506023 ,  0.78014153,  0.9609607 , ...,  0.6499163 ,
           0.5078758 ,  0.31261143],
         [ 0.7974689 ,  1.4422892 ,  1.792707  , ...,  1.1460267 ,
           0.8586473 ,  0.48705122],
         [ 1.0312486 ,  1.9079707 ,  2.3926287 , ...,  1.5233306 ,
           1.1361461 ,  0.62707984],
         ...,
         [ 2.0406818 ,  3.698827  ,  4.5027776 , ...,  3.2008963 ,
           2.4152262 ,  1.339842  ],
         [ 1.5563875 ,  2.8407562 ,  3.4499235 , ...,  2.353441  ,
           1.8101668 ,  1.0320569 ],
         [ 0.86405325,  1.5366974 ,  1.8706379 , ...,  1.2857    ,
           1.0277566 ,  0.62768835]],
        [[ 0.74492425,  1.3323734 ,  1.6315901 , ...,  1.0177698 ,
           0.74940765,  0.41139257],
         [ 1.2948426 ,  2.353371  ,  2.9170818 , ...,  1.7834346 ,
           1.3083605 ,  0.7060629 ],
         [ 1.6571872 ,  3.0512788 ,  3.835495  , ...,  2.3537607 ,
           1.7329134 ,  0.9375017 ],
         ...,
         [ 3.16633   ,  5.824293  ,  7.1573477 , ...,  4.9051266 ,
           3.7011409 ,  2.0575457 ],
         [ 2.332248  ,  4.315041  ,  5.3304434 , ...,  3.512181  ,
           2.6904833 ,  1.531225  ],
         [ 1.2279813 ,  2.2205565 ,  2.8030162 , ...,  1.8191247 ,
           1.429559  ,  0.8520615 ]]],
       ...,
       [[[-0.29813766, -0.533404  , -0.6559599 , ..., -0.51397276,
          -0.41736302, -0.30005324],
         [-0.41360962, -0.8198606 , -1.0384939 , ..., -0.7908081 ,
          -0.6373034 , -0.43024486],
         [-0.49742377, -1.0020006 , -1.2906752 , ..., -0.9514676 ,
          -0.762085  , -0.5107799 ],
         ...,
         [-0.77739847, -1.7246313 , -2.1878076 , ..., -1.5500343 ,
          -1.2483033 , -0.8005891 ],
         [-0.57299244, -1.2406404 , -1.5854508 , ..., -1.0938655 ,
          -0.9145012 , -0.6100621 ],
         [-0.3420332 , -0.7139092 , -0.89926654, ..., -0.5986564 ,
          -0.49647895, -0.33787853]],
        [[ 0.43226838,  0.7474327 ,  0.92197245, ...,  0.65403205,
           0.50407934,  0.30802777],
         [ 0.7645831 ,  1.3826245 ,  1.721306  , ...,  1.1420656 ,
           0.8432397 ,  0.47512922],
         [ 0.99257016,  1.8402263 ,  2.3096752 , ...,  1.5084387 ,
           1.1110798 ,  0.6098495 ],
         ...,
         [ 1.9148542 ,  3.4721093 ,  4.2449536 , ...,  2.7944973 ,
           2.0875993 ,  1.1482421 ],
         [ 1.443189  ,  2.6467366 ,  3.241263  , ...,  2.066555  ,
           1.5834651 ,  0.89770794],
         [ 0.7985659 ,  1.4260038 ,  1.7522295 , ...,  1.1351765 ,
           0.9084894 ,  0.5569178 ]],
        [[ 0.70576775,  1.2640874 ,  1.5556451 , ...,  1.0200601 ,
           0.7399846 ,  0.40304574],
         [ 1.2347128 ,  2.2498796 ,  2.7971373 , ...,  1.7731433 ,
           1.2813827 ,  0.6861526 ],
         [ 1.5984734 ,  2.9409583 ,  3.7015843 , ...,  2.32824   ,
           1.6896124 ,  0.90609616],
         ...,
         [ 2.9525776 ,  5.4472585 ,  6.723266  , ...,  4.273866  ,
           3.189393  ,  1.7513418 ],
         [ 2.159231  ,  4.003967  ,  4.9898605 , ...,  3.0702791 ,
           2.3406222 ,  1.3219199 ],
         [ 1.130858  ,  2.0544133 ,  2.6140218 , ...,  1.5920146 ,
           1.2506576 ,  0.7458056 ]]],
       [[[-0.29038483, -0.50431687, -0.6226442 , ..., -0.50877255,
          -0.4122712 , -0.29564744],
         [-0.3959528 , -0.7664754 , -0.973122  , ..., -0.7909497 ,
          -0.6359496 , -0.42543912],
         [-0.46684292, -0.9321576 , -1.2064497 , ..., -0.9630738 ,
          -0.7697096 , -0.51268125],
         ...,
         [-0.7853483 , -1.7531587 , -2.223221  , ..., -1.393458  ,
          -1.1318179 , -0.73562014],
         [-0.5775984 , -1.2518288 , -1.5982409 , ..., -0.98675126,
          -0.8324275 , -0.5650163 ],
         [-0.34248513, -0.71683246, -0.89952826, ..., -0.5479987 ,
          -0.46070182, -0.3199033 ]],
        [[ 0.40378237,  0.69673836,  0.8699443 , ...,  0.6475024 ,
           0.49834952,  0.30264628],
         [ 0.70947474,  1.286202  ,  1.6223145 , ...,  1.140964  ,
           0.8431898 ,  0.4713796 ],
         [ 0.9208514 ,  1.709482  ,  2.1749854 , ...,  1.5224155 ,
           1.1226083 ,  0.6136541 ],
         ...,
         [ 1.9554034 ,  3.5469387 ,  4.347505  , ...,  2.5129302 ,
           1.8922682 ,  1.0533009 ],
         [ 1.4670861 ,  2.6861203 ,  3.2880237 , ...,  1.852247  ,
           1.4274734 ,  0.8197207 ],
         [ 0.8083017 ,  1.4414171 ,  1.7673616 , ...,  1.0187244 ,
           0.8209357 ,  0.5111123 ]],
        [[ 0.6524382 ,  1.1746277 ,  1.4653211 , ...,  1.0114257 ,
           0.73071975,  0.39345092],
         [ 1.1368802 ,  2.0794444 ,  2.622499  , ...,  1.774767  ,
           1.2835408 ,  0.68014383],
         [ 1.467984  ,  2.7146838 ,  3.4653    , ...,  2.357087  ,
           1.7128012 ,  0.9160394 ],
         ...,
         [ 3.009177  ,  5.5503335 ,  6.8660817 , ...,  3.8216975 ,
           2.875568  ,  1.5949452 ],
         [ 2.196223  ,  4.058514  ,  5.0533614 , ...,  2.739569  ,
           2.0986476 ,  1.1976159 ],
         [ 1.143647  ,  2.0754788 ,  2.6337411 , ...,  1.422928  ,
           1.1238967 ,  0.676268  ]]],
       [[[-0.29238442, -0.51168555, -0.63325983, ..., -0.5426895 ,
          -0.43204394, -0.30429825],
         [-0.4001105 , -0.77660143, -0.98960096, ..., -0.8507663 ,
          -0.66729707, -0.44437283],
         [-0.47220543, -0.94523984, -1.2274569 , ..., -1.029044  ,
          -0.80546236, -0.53768533],
         ...,
         [-0.7905511 , -1.7698034 , -2.270289  , ..., -1.4576505 ,
          -1.2048154 , -0.7967026 ],
         [-0.5834166 , -1.272445  , -1.6349514 , ..., -1.0446393 ,
          -0.89576995, -0.6131848 ],
         [-0.34510243, -0.72499484, -0.91850686, ..., -0.5838478 ,
          -0.4934615 , -0.34223798]],
        [[ 0.40879545,  0.7055559 ,  0.88097847, ...,  0.7035495 ,
           0.52972394,  0.3195517 ],
         [ 0.7161694 ,  1.3001742 ,  1.6423502 , ...,  1.2440242 ,
           0.9010483 ,  0.502439  ],
         [ 0.9284787 ,  1.7255471 ,  2.2022583 , ...,  1.650042  ,
           1.1961666 ,  0.6522663 ],
         ...,
         [ 1.9623331 ,  3.58655   ,  4.422621  , ...,  2.6262355 ,
           2.0074904 ,  1.1334083 ],
         [ 1.4797617 ,  2.7265697 ,  3.364869  , ...,  1.966493  ,
           1.5391579 ,  0.8974363 ],
         [ 0.81631684,  1.4614002 ,  1.8033438 , ...,  1.0899622 ,
           0.89294803,  0.56006604]],
        [[ 0.6611249 ,  1.1913322 ,  1.4865041 , ...,  1.1037711 ,
           0.77983683,  0.41930068],
         [ 1.1475621 ,  2.1022034 ,  2.6553216 , ...,  1.9422896 ,
           1.3719329 ,  0.7275317 ],
         [ 1.4802122 ,  2.7454908 ,  3.518334  , ...,  2.5574954 ,
           1.8231856 ,  0.97607636],
         ...,
         [ 3.0346363 ,  5.6195474 ,  6.9970417 , ...,  4.018726  ,
           3.0725517 ,  1.732324  ],
         [ 2.2157698 ,  4.1268973 ,  5.1785936 , ...,  2.9241118 ,
           2.2811575 ,  1.3256433 ],
         [ 1.1565087 ,  2.1053271 ,  2.6926346 , ...,  1.5340632 ,
           1.2325629 ,  0.75198394]]]], dtype=float32)
(32, 3, 31, 49)
*** AttributeError: 'list' object has no attribute 'shape'
3
*** TypeError: list indices must be integers or slices, not tuple
*** TypeError: list indices must be integers or slices, not tuple
*** TypeError: list indices must be integers or slices, not tuple
(32, 31, 49)
(32, 31, 49)
(32, 31, 49)
*** IndexError: index 3 is out of bounds for axis 1 with size 3
3
Traceback (most recent call last):
  File "/Users/kelseydoerksen/code/sudsaq-kelsey-research/research/kelsey/unet/run_pipeline.py", line 133, in <module>
    run_cqr(unet, device, aq_train_dataset, aq_test_dataset, save_dir, experiment, 0.1, args.channels,
  File "/Users/kelseydoerksen/code/sudsaq-kelsey-research/research/kelsey/unet/run_cqr.py", line 305, in run_cqr
    # --- Calculate the coverage from the un-calibrated predictions
  File "/Users/kelseydoerksen/code/sudsaq-kelsey-research/research/kelsey/unet/run_cqr.py", line 305, in run_cqr
    # --- Calculate the coverage from the un-calibrated predictions
  File "/Users/kelseydoerksen/opt/anaconda3/envs/sudsaq-uq/lib/python3.10/bdb.py", line 90, in trace_dispatch
    return self.dispatch_line(frame)
  File "/Users/kelseydoerksen/opt/anaconda3/envs/sudsaq-uq/lib/python3.10/bdb.py", line 115, in dispatch_line
    if self.quitting: raise BdbQuit
bdb.BdbQuit
If you suspect this is an IPython 8.25.0 bug, please report it at:
    https://github.com/ipython/ipython/issues
or send an email to the mailing list at ipython-dev@python.org
You can print a more detailed traceback right now with "%tb", or use "%debug"
to interactively debug it.
Extra-detailed tracebacks for bug-reporting purposes can be enabled via:
    %config Application.verbose_crash=True